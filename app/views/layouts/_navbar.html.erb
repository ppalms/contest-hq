<nav
  data-controller="dropdown"
  data-turbo-prefetch="false"
  class="w-full bg-white border-b border-b-stone-300 shadow-2xs"
>
  <div class="flex items-center justify-between">
    <div class="flex items-center pl-2">
      <button
        class="hamburger hamburger--boring"
        type="button"
        data-dropdown-target="navMenuButton"
        data-action="click->dropdown#toggleNavMenu"
      >
        <span class="hamburger-box">
          <span class="hamburger-inner"></span>
        </span>
      </button>
    </div>

    <div class="absolute left-1/2 transform -translate-x-1/2 font-bold text-center">
      <span>
        <% if Current.selected_account %>
          <%= link_to "#{Current.selected_account.name} Contest HQ", root_path %>
        <% elsif Current.account&.name != "Contest HQ" && current_user&.sys_admin? == false %>
          <%= link_to "#{current_user.account.name} Contest HQ", root_path %>
        <% else %>
          <%= link_to "Contest HQ", root_path %>
        <% end %>
      </span>
    </div>

    <% if Current.session %>
      <div class="lg:pl-72">
        <div
          class="sticky top-0 z-40 flex h-12 shrink-0 items-center gap-x-4 bg-white pr-2"
        >
          <div class="flex flex-1 gap-x-4 self-stretch lg:gap-x-6">
            <div class="flex items-center gap-x-4 lg:gap-x-6">
              <!-- Profile dropdown -->
              <div class="relative">
                <button
                  type="button"
                  class="-m-1.5 flex items-center p-1.5 hover:cursor-pointer"
                  id="user-menu-button"
                  aria-expanded="false"
                  aria-haspopup="true"
                  data-dropdown-target="button"
                  data-action="dropdown#toggle"
                >
                  <span class="sr-only">Open user menu</span>
                  <span class="hidden lg:flex lg:items-center lg:gap-x-2">
                    <span class="ml-4 flex flex-col">
                      <span class="text-sm/6 font-semibold text-gray-900" aria-hidden="true"><%= "#{current_user.first_name} #{current_user.last_name}" %></span>
                      <span class="text-[10px] font-normal text-gray-600 uppercase tracking-wide" aria-hidden="true"><%= current_user.role_display_names.join(", ") %></span>
                    </span>
                    <svg
                      class="size-5 text-gray-400"
                      viewBox="0 0 20 20"
                      fill="currentColor"
                      aria-hidden="true"
                      data-slot="icon"
                    >
                      <path
                        fill-rule="evenodd"
                        d="M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z"
                        clip-rule="evenodd"
                      />
                    </svg>
                  </span>
                </button>
                <!-- Dropdown menu, show/hide based on menu state. Entering:
                "transition ease-out duration-100" From: "transform opacity-0
                scale-95" To: "transform opacity-100 scale-100" Leaving:
                "transition ease-in duration-75" From: "transform opacity-100
                scale-100" To: "transform opacity-0 scale-95" -->
                <div
                  id="user-menu"
                  data-dropdown-target="menu"
                  class="
                    hidden absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-sm bg-white
                    py-2 ring-1 shadow-lg ring-gray-900/5 focus:outline-hidden
                  "
                  role="menu"
                  aria-orientation="vertical"
                  aria-labelledby="user-menu-button"
                  tabindex="-1"
                >
                  <!-- Active: "bg-gray-50 outline-hidden", Not Active: "" -->
                  <% if current_user&.sys_admin? %>
                    <div class="px-3 py-2 text-xs text-gray-500 border-b">
                      Account Context
                    </div>
                    <div class="px-3 py-2">
                      <%= render "shared/account_switcher" %>
                    </div>
                    <div class="border-t border-gray-200 my-1"></div>
                  <% end %>
                  
                  <%= link_to edit_identity_profile_path,
                  class: "group flex items-center justify-between px-3 py-1 text-sm/6 text-gray-900 transition-all duration-150 hover:font-bold" do %>
                    <span>Your profile</span>
                    <svg class="size-4 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity duration-150" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                      <path fill-rule="evenodd" d="M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L12.94 10 8.22 5.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" />
                    </svg>
                  <% end %>

                  <%= link_to settings_path,
                  class: "group flex items-center justify-between px-3 py-1 text-sm/6 text-gray-900 transition-all duration-150 hover:font-bold" do %>
                    <span>Settings</span>
                    <svg class="size-4 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity duration-150" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                      <path fill-rule="evenodd" d="M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L12.94 10 8.22 5.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" />
                    </svg>
                  <% end %>

                  <%= button_to Current.session,
                  method: :delete,
                  form_class: "w-full",
                  class: "group flex items-center justify-between w-full px-3 py-1 text-sm/6 text-gray-900 transition-all duration-150 hover:font-bold cursor-pointer text-left" do %>
                    <span>Sign out</span>
                    <svg class="size-4 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity duration-150" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                      <path fill-rule="evenodd" d="M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L12.94 10 8.22 5.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" />
                    </svg>
                  <% end %>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    <% end %>
  </div>

  <div
    id="nav-menu"
    data-dropdown-target="navMenu"
    class="
      absolute hidden w-full pl-2 bg-white border-b border-b-stone-300 shadow z-50
    "
  >
    <div class="p-2 pb-4 space-y-1">
      <% if Current.session %>
        <%= link_to root_path, class: "group flex items-center justify-between px-3 py-2 text-gray-900 transition-all duration-150 hover:font-bold mt-4" do %>
          <span>Home</span>
          <svg class="size-4 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity duration-150" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
            <path fill-rule="evenodd" d="M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L12.94 10 8.22 5.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" />
          </svg>
        <% end %>

        <%= link_to contests_path, class: "group flex items-center justify-between px-3 py-2 text-gray-900 transition-all duration-150 hover:font-bold" do %>
          <span>Contests</span>
          <svg class="size-4 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity duration-150" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
            <path fill-rule="evenodd" d="M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L12.94 10 8.22 5.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" />
          </svg>
        <% end %>

        <% if current_user.director? %>
          <%= link_to roster_path, class: "group flex items-center justify-between px-3 py-2 text-gray-900 transition-all duration-150 hover:font-bold" do %>
            <span>Roster</span>
            <svg class="size-4 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity duration-150" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
              <path fill-rule="evenodd" d="M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L12.94 10 8.22 5.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" />
            </svg>
          <% end %>
        <% end %>

        <%= link_to prescribed_music_index_path, class: "group flex items-center justify-between px-3 py-2 text-gray-900 transition-all duration-150 hover:font-bold" do %>
          <span>Prescribed Music</span>
          <svg class="size-4 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity duration-150" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
            <path fill-rule="evenodd" d="M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L12.94 10 8.22 5.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" />
          </svg>
        <% end %>

        <% if current_user.admin? %>
          <%= link_to organizations_path, class: "group flex items-center justify-between px-3 py-2 text-gray-900 transition-all duration-150 hover:font-bold" do %>
            <span>Organizations</span>
            <svg class="size-4 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity duration-150" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
              <path fill-rule="evenodd" d="M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L12.94 10 8.22 5.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" />
            </svg>
          <% end %>

          <%= link_to seasons_path, class: "group flex items-center justify-between px-3 py-2 text-gray-900 transition-all duration-150 hover:font-bold" do %>
            <span>Seasons</span>
            <svg class="size-4 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity duration-150" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
              <path fill-rule="evenodd" d="M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L12.94 10 8.22 5.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" />
            </svg>
          <% end %>

          <%= link_to users_path, class: "group flex items-center justify-between px-3 py-2 text-gray-900 transition-all duration-150 hover:font-bold" do %>
            <span>Users</span>
            <svg class="size-4 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity duration-150" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
              <path fill-rule="evenodd" d="M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L12.94 10 8.22 5.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" />
            </svg>
          <% end %>
        <% end %>

        <div class="lg:hidden pt-4 border-t border-gray-200 mt-4 space-y-1">
          <%= link_to edit_identity_profile_path, class: "group flex items-center justify-between px-3 py-2 text-gray-900 transition-all duration-150 hover:font-bold" do %>
            <span>Your profile</span>
            <svg class="size-4 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity duration-150" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
              <path fill-rule="evenodd" d="M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L12.94 10 8.22 5.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" />
            </svg>
          <% end %>

          <%= link_to settings_path, class: "group flex items-center justify-between px-3 py-2 text-gray-900 transition-all duration-150 hover:font-bold" do %>
            <span>Settings</span>
            <svg class="size-4 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity duration-150" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
              <path fill-rule="evenodd" d="M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L12.94 10 8.22 5.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" />
            </svg>
          <% end %>

          <%= button_to Current.session, method: :delete, form_class: "w-full", class: "group flex items-center justify-between w-full px-3 py-2 text-gray-900 transition-all duration-150 hover:font-bold cursor-pointer text-left" do %>
            <span>Sign out</span>
            <svg class="size-4 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity duration-150" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
              <path fill-rule="evenodd" d="M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L12.94 10 8.22 5.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" />
            </svg>
          <% end %>
        </div>
      <% else %>
        <%= button_to "Sign in", sign_in_path, method: :get %>
      <% end %>
    </div>
  </div>
</nav>
