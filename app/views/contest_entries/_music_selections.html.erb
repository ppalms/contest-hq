<% content_for :title, "Music Selections" %>
<%= turbo_frame_tag "music_selections" do %>
  <div class="pt-8 gap-4">
    <div class="flex justify-between items-center mb-4">
      <div>
        <h2>Music Selections</h2>
        <% if @contest_entry.music_complete? %>
          <p class="text-sm text-green-600 font-medium mt-1">âœ“ Complete (3/3 pieces selected)</p>
        <% else %>
          <p class="text-sm text-gray-600 mt-1">
            <%= @contest_entry.music_selections.count %>/3 pieces selected
          </p>
        <% end %>
      </div>
      <% if current_user.contest_entries.include?(@contest_entry) %>
        <div>
          <%= link_to "Edit",
                      bulk_edit_contest_entry_selections_path(entry_id: @contest_entry.id),
                      class: "btn-secondary-sm",
                      data: { turbo_frame: "music_selections" } %>
        </div>
      <% end %>
    </div>

    <%= render "contest_entries/previous_music_prompt" if @show_copy_prompt %>

    <% if @contest_entry.music_selections.any? %>
      <ul class="divide-y divide-gray-200 border border-gray-200 rounded-lg">
        <% @contest_entry.music_selections.order(:position).each_with_index do |music_selection, index| %>
          <%= render "contest_entries/music_selection_item", music_selection: music_selection, index: index %>
        <% end %>
      </ul>
    <% else %>
      <div class="text-center py-12 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300">
        <p class="text-gray-600 mb-4">No music selections yet</p>
        <% if current_user.contest_entries.include?(@contest_entry) %>
          <div class="flex gap-2 justify-center">
            <%= link_to "Select Prescribed Music",
                        select_prescribed_contest_entry_selections_path(entry_id: @contest_entry.id),
                        class: "btn-primary-sm" %>
            <%= link_to "Add Custom Music",
                        select_custom_contest_entry_selections_path(entry_id: @contest_entry.id, slot: 1),
                        class: "btn-secondary-sm" %>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>
<% end %>
